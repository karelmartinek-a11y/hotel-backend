{% extends "base.html" %}

{% set show_admin_sidebar = show_admin_sidebar|default(true) %}
{% set use_sidebar = show_admin_sidebar %}

{% block sidebar %}
  {% include "admin_sidebar.html" %}
{% endblock %}
{% set inventory_base_path = inventory_base_path|default('/admin/inventory') %}
{% set readonly = readonly|default(false) %}
{% set back_url = back_url|default('') %}

{% block title %}ASC Hotel Chodov — Skladové hospodářství (Stav skladu){% endblock %}

{% block head_extra %}{% endblock %}

{% block content %}
  {% if back_url %}
    <div style="margin-bottom:10px;">
      <a href="{{ back_url }}" class="kajovo-btn kajovo-btn--secondary">Zpět</a>
    </div>
  {% endif %}

  <div class="kajovo-pagehead">
    <div>
      <h1>Skladové hospodářství</h1>
      <div class="kajovo-subtitle">Suroviny pro snídaně + příjmové/výdajové karty.</div>
    </div>
  </div>

  <div style="display:flex;gap:10px;flex-wrap:wrap;margin-bottom:14px;">
    <a href="{{ inventory_base_path }}/ingredients" class="kajovo-btn {% if inventory_section=='ingredients' %}kajovo-btn--primary{% else %}kajovo-btn--secondary{% endif %}">Správa surovin</a>
    <a href="{{ inventory_base_path }}/stock" class="kajovo-btn {% if inventory_section=='stock' %}kajovo-btn--primary{% else %}kajovo-btn--secondary{% endif %}">Stav skladu</a>
    <a href="{{ inventory_base_path }}/movements" class="kajovo-btn {% if inventory_section=='movements' %}kajovo-btn--primary{% else %}kajovo-btn--secondary{% endif %}">Pohyby na skladu</a>
  </div>

  <section class="kajovo-surface kajovo-card">
    <div style="display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:10px;">
      <div>
        <div style="font-weight:750;">Stav skladu</div>
        <div class="kajovo-subtitle">Aktuální množství každé položky v základní jednotce i podle definovaných kusů.</div>
      </div>
      <button class="kajovo-btn kajovo-btn--secondary" type="button" onclick="window.print()">Export do PDF</button>
    </div>

    <div style="overflow:auto;margin-top:12px;">
            <table class="kajovo-table">
              <thead>
                <tr>
                  <th>Surovina</th>
                  <th>1 ks</th>
                  <th>Stav</th>
                  <th>Základ</th>
                </tr>
              </thead>
              <tbody>
                {% for row in inventory_summary %}
                  <tr>
                    <td>{{ row.name }}</td>
                    <td>
                      {% if row.per_piece %}
                        {{ row.per_piece }} {{ row.unit_label }}
                      {% else %}
                        <span class="mini">nenastaveno</span>
                      {% endif %}
                    </td>
                    <td style="font-weight:850;">{{ row.stock_text }}</td>
                    <td class="mini">{{ row.base_qty }} {{ row.unit_label }}</td>
                  </tr>
                {% endfor %}
              </tbody>
            </table>
          </div>
  </section>
{% endblock %}
